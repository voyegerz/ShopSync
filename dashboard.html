<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shop Sync</title>

    <!-- main stylesheet -->
    <link rel="stylesheet" href="styles/style.css" />

    <!-- page stylesheet  -->
    <link rel="stylesheet" href="styles/register.css" />
    <link rel="stylesheet" href="styles/dashboard.css" />
  </head>
  <body>
    <!-- header start -->
    <div class="header">
      <!-- logo  -->
      <div class="logo">
        <span id="logo-cursib">Shop</span>
        <span id="logo-name">Sync</span>
      </div>

      <!-- nav links  -->
      <nav class="nav-links">
        <a href="index.html">HOME</a>
        <a href="shop.html">EXPLORE</a>
      </nav>

      <!-- searchbar  -->
      <div class="search-container">
        <input type="text" name="searchbar" id="main-search" />
        <img id="search-icon" src="assets/icons/search (2).png" alt="" />
      </div>

      <!-- cart  -->
      <div class="cart" style="display: none;">
        <a href="cart.html"
          ><img src="assets/icons/cart.png" alt="" class="cart-btn"
        /></a>
      </div>

      <div class="dashboard" style="display: none;">
        <a href="dashboard.html">
          <img src="assets/icons/dashboard-icon.png" class="cart-btn" alt="" />
        </a>
      </div>

      <!-- login  -->
      <a class="login-btn" id="login-btn" href="login.html">Log In</a>

      <!-- logout -->
      <a class="login-btn log-out" id="logout-btn" style="display: none"
        >Log Out</a
      >
    </div>
    <!-- header end  -->

    <!-- main container-body -->
    <div class="main-container">
      <!-- dashboard head boxes  start-->
      <div class="head-box-container">
        <div class="head-box h1">
          <img src="/assets/icons/prod.png" alt="" />
          <p>
            Total Products<br /><span id="total-no">571</span>
            <span id="add-product-btn">+ Add Products</span>
          </p>
        </div>

        <div class="head-box h2">
          <img src="/assets/icons/prod.png" alt="" />
          <p>
            Out of Stock<br /><span id="total-no">60</span>
            <span id="inventory-text"
              ><img id="img-inventory" src="/assets/icons/boxes.png" alt="" />
              Show Inventory</span
            >
          </p>
        </div>

        <div class="head-box h3">
          <img src="/assets/icons/user.png" alt="" />
          <p>People at Shop<br /><span id="total-no">20</span></p>
        </div>

        <div class="head-box h4">
          <img src="/assets/icons/prod.png" alt="" />
          <p>Limited in Stock<br /><span id="total-no">5</span></p>
        </div>
      </div>
      <!-- dashboard head boxes end-->

      <!-- Add Products Section -->
      <div class="add-product-container">
        <h1>Add Products to Your Inventory</h1>

        <table>
          <thead>
            <tr>
              <th>Ser.</th>
              <th>Name</th>
              <th>Price [₹]</th>
              <th>Quantity</th>
              <th>P Type</th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <!-- Example Row 1 -->
            <tr>
              <td>1</td>
              <td><input class="inp-prod p_name" id="p_name" type="text" /></td>
              <td>
                <input class="inp-prod p_price" type="text" id="p_price" />
              </td>
              <td>
                <input
                  class="inp-prod p_quant"
                  type="text"
                  id="p_quant"
                  name=""
                />
              </td>
              <td>
                <input
                  class="inp-prod p_type"
                  type="text"
                  id="p_type"
                  name=""
                />
              </td>
              <td>
                <button class="del-prod-row" style="display: none">
                  <div class="line l-1"></div>
                  <div class="line l-2"></div>
                </button>
              </td>
              <td><button class="add-prod-row">+ Add More</button></td>
            </tr>
          </tbody>
        </table>

        <button id="add-inv-btn">Add to Inventory</button>
      </div>

      <!-- Inventory Show Section -->
      <div class="product-inventory-container add-product-container">
        <div class="inventory-header">
          <h1>Product Inventory</h1>
          <div class="filtering-components">
            <!-- filter -->
            <div class="filter">
              <label for="" class="filter-label" id="p_filter">Filter</label>
              <select name="filter-dropdown" id="filter-dropdown">
                <optgroup label="Products">
                  <option value="electronic">Electronic</option>
                  <option value="health">Health</option>
                </optgroup>
                <optgroup label="Services">
                  <option value="food-places">Food Places</option>
                  <option value="toor-places">Toor Places</option>
                </optgroup>
              </select>
            </div>

            <!-- search -->
            <div class="searchbox">
              <input
                type="text"
                class="search-box-input"
                id="search-inp-element"
                placeholder="@Search"
              />
              <button class="cancel-search-btn" style="display: none;">
                <div class="c-btn-line c-l-1"></div>
                <div class="c-btn-line c-l-2"></div>
              </button>
              <button class="search-prod-btn">
                <img
                  class="search-prod-btn-img"
                  src="assets/icons/search-list-big.png"
                  alt=""
                />
              </button>
            </div>
          </div>
        </div>

        <hr />

        <table>
          <thead>
            <tr>
              <th>Ser.</th>
              <th>Id</th>
              <th>Name</th>
              <th>Price [₹]</th>
              <th>Quantity</th>
              <th>LM Date</th>
              <th>PType</th>
              <th></th>
              <th></th>
            </tr>
            <tr>
              <th><hr /></th>
              <th><hr /></th>
              <th><hr /></th>
              <th><hr /></th>
              <th><hr /></th>
              <th><hr /></th>
              <th><hr /></th>
            </tr>
          </thead>
          <tbody>
            <!-- Example Row 1 -->
            <tr>
              <td>1</td>
              <td><input type="text" class="inp-prod" id="p_id" /></td>
              <td><input class="inp-prod" id="p_name" type="text" /></td>
              <td><input class="inp-prod" type="text" id="p_price" /></td>
              <td>
                <input
                  class="inp-prod"
                  type="text"
                  id="p_quant"
                  name=""
                  id=""
                />
              </td>
              <td><input type="text" class="inp-prod" id="lm-date" /></td>
              <td><input type="text" class="inp-prod" id="p_type" /></td>
              <td>
                <button class="edit-prod-row-btn edit-prod-btn">
                  <img src="/assets/icons/edit-btn-big.png" alt="" />
                </button>
              </td>
              <td>
                <button class="update-prod-row-btn add-prod-row">
                  Update ↑
                </button>
              </td>
            </tr>
          </tbody>
        </table>

        <div class="center">
          <div class="pagination">
            <a href="#">←</a>
            <a href="#">1</a>
            <a href="#" class="active">2</a>
            <a href="#">3</a>
            <a href="#">4</a>
            <a href="#">5</a>
            <a href="#">6</a>
            <a href="#">→</a>
          </div>
        </div>
      </div>
    </div>

    <!-- footer start  -->
    <div class="footer">
      <!-- footer-text  -->
      <div class="footer-text">
        <!-- logo  -->
        <div class="logo footer-logo">
          <span id="logo-cursib">Books by</span>
          <span id="logo-name">Neeraj</span>
        </div>

        <p class="footer-text-para">
          A Curated Book Collection Where anyone can see the books buy the books
          and save them into there wishlist to buy later. <br /><br />
          <span id="dev-name-heading">Designed & Developed By</span><br />
          <span id="dev-name">Neeraj Kumar</span>
        </p>

        <div class="share-links">
          <a href=""> <img src="assets/icons/linkedin.png" alt="" /></a>
          <a href=""> <img src="assets/icons/facebook.png" alt="" /></a>
          <a href=""> <img src="assets/icons/whatsapp.png" alt="" /></a>
          <a href=""> <img src="assets/icons/instagram.png" alt="" /></a>
          <img
            class="profile-footer"
            src="assets/images/IMG_20221205_225853_077.jpg"
            alt=""
          />
        </div>

        <!-- bg circle 4  -->
        <div class="bg-circle-4 effect"></div>
      </div>

      <!-- footer links  -->
      <div class="footer-links">
        <div class="product-links links-cat">
          <p class="link-heading">Product</p>
          <a href="" class="link">Download</a>
          <a href="" class="link">Pricing</a>
          <a href="" class="link">Server</a>
        </div>

        <div class="user-links links-cat">
          <p class="link-heading">User</p>
          <a href="" class="footer-register">Register</a>
          <a href="" class="login">Login</a>
          <a href="" class="shop">Shop</a>
          <a href="" class="link-category">Categories</a>
        </div>

        <div class="engage-links links-cat">
          <p class="link-heading">Engage</p>
          <a href="" class="about-us">About Us</a>
          <a href="" class="contact-us"> Contact Us</a>
        </div>
      </div>
    </div>

    <!-- copyright  -->
    <p class="copyright">All Copyrightes Reserved @ Neeraj Kumar ;]</p>

    <!-- background circles effect  -->
    <div class="bg-circle-1 effect"></div>
    <script>
      //LOGOUT SECTION CODE START////////////////////////////////////////////////////////////////
      const login_btn = document.querySelector("#login-btn");
      const logout_btn = document.querySelector("#logout-btn");
      const header = document.querySelector(".header");
      const cart = document.querySelector(".cart");
      const dashboard = document.querySelector(".dashboard");

      // on page load do the following
      function onPageLoad() {
        const name_data_element = document.createElement("p");

        name_data_element.classList.add("session-name");

        const session_id = window.sessionStorage.getItem("id");
        const session_name = window.sessionStorage.getItem("name");
        const role = window.sessionStorage.getItem("role");
        const status = window.sessionStorage.getItem("status");

        if (status == "success") {
          if (session_name != null) {
            name_data_element.textContent = "Hi\n" + session_name.split(" ")[0];
          }
          header.appendChild(name_data_element);

          if (session_id && session_name != null) {
            login_btn.style.display = "none";
            logout_btn.style.display = "block";
          }
          if (role == "user") {
            cart.style.display = "block";
          } else if (role == "shop_keeper") {
            cart.style.display = "block";
            dashboard.style.display = "block";
          }
        } else if (status == "fail") {
          alert(" Failed to login , Invalid Username or Password.");
        }
      }
      window.onload = onPageLoad();

      async function logOut() {
        try {
          const response = await fetch(
            "https://shopsync.pythonanywhere.com/logout"
          );

          if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
          }

          const result = await response.json();
          console.log(result);
          alert(result["msg"]);
        } catch (error) {
          console.error("Error:", error);
          alert(
            "Error registering user. Please check the console for details."
          );
        }
      }

      logout_btn.addEventListener("click", function (event) {
        logOut().then(clearSessionAndReload);
      });

      function clearSessionAndReload() {
        sessionStorage.clear();
        window.location.reload();
      }
      //LOGOUT SECTION CODE END//////////////////////////////////////////////////////////////////////////////////////////////
    </script>
    <script src="/scripts/add_prods.js"></script>
    <script src="scripts/prod_inventory.js"></script>
  </body>
</html>
